<!DOCTYPE html>
<!-- Entry HTML template that loads the Fractal Recipe React bundle and shared styles. -->
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fractal Recipe Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>

    <!-- Removed importmap: Vite handles module resolution -->
    <style>
      @keyframes scanline { 0% { background-position: 0% 0%; } 100% { background-position: 0% 100%; } }
      @keyframes neon-glow { 0%, 100% { text-shadow: 0 0 5px #fff, 0 0 10px #0ff, 0 0 15px #0ff, 0 0 20px #0ff; } 50% { text-shadow: 0 0 10px #fff, 0 0 20px #0ff, 0 0 30px #0ff, 0 0 40px #0ff; } }
      @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); } 20%, 40%, 60%, 80% { transform: translateX(2px); } }
      @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
      @keyframes modal-content-swoop-in { from { opacity: 0; transform: scale(0.95) translateY(15px); } to { opacity: 1; transform: scale(1) translateY(0); } }
      @keyframes rotateCube { from { transform: rotateX(0deg) rotateY(0deg); } to { transform: rotateX(360deg) rotateY(360deg); } }
      @keyframes pulse-red-glow {
        0%, 100% { box-shadow: 6px 6px #000, 0 0 5px rgba(255,0,0,0.2); }
        50% { box-shadow: 6px 6px #000, 0 0 25px rgba(255,0,0,0.9), 0 0 10px rgba(255,0,0,0.6); }
      }
      @keyframes selected-glow-pulse {
        50% { box-shadow: 0 0 15px rgba(0,255,255,0.8), inset 0 0 10px rgba(0,255,255,0.5); }
      }
      @keyframes theme-glow-pulse {
        50% { box-shadow: 0 0 12px #0ff, inset 0 0 10px rgba(0, 255, 255, 0.4); }
      }
      @keyframes fadeInUp {
        from { opacity: 0; transform: translate(-50%, 20px); }
        to { opacity: 1; transform: translate(-50%, 0); }
      }
      @keyframes processing-flash {
        50% {
          filter: brightness(1.75);
          border-color: #0ff;
        }
      }
      @keyframes saved-flash {
        50% {
          background-color: #ff0;
          color: #000;
          transform: scale(1.05);
          box-shadow: 0 0 10px #ff0;
        }
      }
      @keyframes fake-progress {
        from { width: 0%; }
        to { width: 95%; }
      }
      @keyframes pop-in-out {
        0%, 100% { opacity: 0; transform: translate(-50%, 5px) scale(0.8); }
        20%, 80% { opacity: 1; transform: translate(-50%, 0) scale(1); }
      }
      @keyframes content-fade-in { from { opacity: 0; } to { opacity: 1; } }

      /* --- Animations for Cube Faces --- */
      @keyframes glitch-error {
        0%, 100% { transform: translate(0, 0) scale(1); filter: none; }
        10% { transform: translate(-2px, 2px) skewX(5deg) scale(1.05); }
        20% { transform: translate(2px, -2px) skewX(-5deg) scale(1.05); text-shadow: 0 0 10px #f0f; }
        30% { transform: translate(-1px, 1px) skewX(2deg) scale(1.05); filter: brightness(1.8) contrast(1.5); }
        40% { transform: translate(1px, -1px) skewX(-2deg) scale(1.05); }
        50% { transform: translate(0, 0) scale(1.05); text-shadow: 0 0 20px #ff0; }
        60% { transform: translate(2px, 1px) skewX(3deg) scale(1.05); }
        70% { transform: translate(-2px, -1px) skewX(-3deg) scale(1.05); filter: saturate(3); }
        80% { transform: translate(1px, 2px) skewX(1deg) scale(1.05); }
        90% { transform: translate(-1px, -2px) skewX(-1deg) scale(1.05); }
      }
      @keyframes spin-slow {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
      @keyframes core-pulse {
        0%, 100% { transform: scale(1); filter: drop-shadow(0 0 2px #0f0); }
        50% { transform: scale(1.08); filter: drop-shadow(0 0 10px #0ff) drop-shadow(0 0 4px #fff); }
      }
      @keyframes text-flicker-in {
        0% { opacity: 0; text-shadow: 0 0 10px #ff0; }
        20% { opacity: 1; text-shadow: 2px 2px #000; }
        22% { opacity: 0.8; text-shadow: 0 0 10px #ff0; }
        25% { opacity: 1; text-shadow: 2px 2px #000; }
        80% { opacity: 1; text-shadow: 2px 2px #000; }
        82% { opacity: 0.7; }
        85% { opacity: 1; }
      }
      @keyframes icon-nudge {
        0%, 100% { transform: rotate(0deg); }
        25% { transform: rotate(-5deg); }
        75% { transform: rotate(5deg); }
      }
      @keyframes icon-pop-in {
        0% { transform: scale(0.5) rotate(-30deg); opacity: 0; }
        70% { transform: scale(1.2) rotate(10deg); opacity: 1; }
        100% { transform: scale(1) rotate(0deg); opacity: 1; }
      }
      @keyframes face-flash-success {
        50% {
          box-shadow: inset 0 0 30px #0ff, 0 0 20px #0ff;
          border-color: #fff;
        }
      }
      @keyframes chaotic-drift {
        0% { transform: translate(0, 0) rotate(0deg); }
        25% { transform: translate(5px, 8px) rotate(10deg); }
        50% { transform: translate(-5px, -5px) rotate(-5deg); }
        75% { transform: translate(8px, -4px) rotate(8deg); }
        100% { transform: translate(0, 0) rotate(0deg); }
      }
      @keyframes face-idle-pulse {
        50% {
          background: rgba(0, 255, 0, 0.22);
          box-shadow: inset 0 0 15px rgba(0,255,0,0.65);
        }
      }
      
      .animate-fade-in { animation: content-fade-in 0.4s ease-out; }
      .saved-animation { animation: saved-flash 0.8s ease-in-out; }
      .animate-glitch-error { animation: glitch-error 0.4s ease-in-out 2; }
      .animate-spin-slow { animation: spin-slow 10s linear infinite; }
      .animate-core-pulse { animation: core-pulse 3s ease-in-out infinite; }
      .animate-icon-nudge { animation: icon-nudge 2.5s ease-in-out infinite alternate; display: inline-block; }
      .animate-icon-pop-in { animation: icon-pop-in 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: inline-block; }
      .animate-shake { animation: shake 0.5s ease-in-out 1; }
      .animate-selected { animation: selected-glow-pulse 1s infinite; }
      .animate-face-flash { animation: face-flash-success 0.5s ease-out 1; }
      .animate-face-pulse { animation: face-idle-pulse 4s ease-in-out infinite; }
      
      .recycle-letter {
        position: absolute;
        top: 50%;
        left: 50%;
        /* Transition is now set dynamically in the component */
      }
      .is-drifting {
        animation: chaotic-drift 8s ease-in-out infinite;
      }

      body {
        font-family: 'Press Start 2P', cursive;
        background-color: #000;
        color: #0F0;
        text-shadow: 2px 2px #000;
        overflow: hidden;
      }
      body::before {
        content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        background-image: repeating-linear-gradient(0deg, #000, #000 1px, #0F0 1px, #0F0 2px);
        background-size: 100% 4px;
        animation: scanline 5s linear infinite;
        opacity: 0.1;
        z-index: -1;
        pointer-events: none;
      }
      #root { height: 100vh; }
      .pixel-font-big { font-size: 2.5rem; letter-spacing: 2px; text-shadow: 4px 4px #000; color: #FF0; animation: neon-glow 2s ease-in-out infinite alternate; }
      .pixel-font-medium { font-size: 1.2rem; letter-spacing: 1.5px; text-shadow: 3px 3px #000; color: #FF0; }
      .pixel-font-small { font-size: 0.7rem; letter-spacing: 0.5px; text-shadow: 2px 2px #000; color: #0F0; }
      .arcade-button { font-family: 'Press Start 2P', cursive; background: linear-gradient(to bottom, #F00, #A00); border: 4px solid #333; color: #FFF; text-shadow: 2px 2px #000; font-size: 1.2rem; padding: 10px 20px; box-shadow: 6px 6px #000, inset 2px 2px 8px rgba(255,255,255,0.4); transition: all 0.1s ease-in-out; cursor: pointer; }
      .arcade-button:hover { transform: translateY(-2px); box-shadow: 8px 8px #000, inset 2px 2px 8px rgba(255,255,255,0.6); }
      .arcade-button:active, .arcade-button.loading { transform: translateY(2px); box-shadow: 2px 2px #000, inset 0 0 5px rgba(255,255,255,0.2); }
      .arcade-button.loading { animation: shake 0.5s ease-in-out infinite alternate; }
      .has-error .arcade-button { animation: pulse-red-glow 1.5s infinite; border-color: #f55; }
      .arcade-button-small { font-family: 'Press Start 2P', cursive; background-color: #0F0; color: #000; padding: 5px 10px; border: 1px solid #0F0; font-size: 0.7rem; cursor: pointer; box-shadow: 2px 2px #000; transition: all 0.1s; } .arcade-button-small:hover { background-color: #FF0; border-color: #FF0; } .arcade-button-small:active { transform: translateY(1px); box-shadow: 1px 1px #000; } .arcade-button-small:disabled { background-color: #555; color: #aaa; border-color: #333; cursor: not-allowed; transform: none; box-shadow: 2px 2px #000; }
      .arcade-option-button { transition: all 0.1s ease-in-out; }
      .arcade-option-button:active { transform: translateY(1px) scale(0.95); box-shadow: 0 0 15px rgba(0,255,255,0.8), inset 0 0 10px rgba(0,255,255,0.5); }
      .arcade-select {
        font-family: 'Press Start 2P', cursive;
        background-color: #000;
        border: 2px solid #0f0;
        color: #0f0;
        padding: 4px 8px;
        font-size: 0.7rem;
        box-shadow: inset 0 0 5px rgba(0,255,0,0.4);
        -webkit-appearance: none;
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%230f0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 0.5rem center;
        background-size: 1em;
        padding-right: 2rem;
      }
      .arcade-select:focus { outline: none; border-color: #0ff; box-shadow: inset 0 0 8px rgba(0,255,255,0.6), 0 0 5px rgba(0,255,255,0.6); }
      .arcade-toggle-switch { cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 4px; }
      .arcade-toggle-switch .switch-track { width: 50px; height: 20px; background-color: #333; border: 2px solid #555; position: relative; transition: all 0.2s; box-shadow: inset 0 0 5px #000; }
      .arcade-toggle-switch .switch-handle { width: 18px; height: 18px; background-color: #888; border: 2px solid #222; position: absolute; top: -1px; left: -1px; transition: all 0.2s ease-in-out; box-shadow: 2px 2px #000; }
      .arcade-toggle-switch.toggled .switch-track { background-color: #050; border-color: #0f0; box-shadow: inset 0 0 8px rgba(0,255,0,0.5); }
      .arcade-toggle-switch.toggled .switch-handle { transform: translateX(30px); background-color: #ff0; }
      .icon-pixel { font-size: 2.5rem !important; line-height: 1; }
      .cube-container { perspective: 1200px; display: flex; justify-content: center; align-items: center; height: 100%; position: absolute; inset: 0;}
      .cube { position: relative; width: 200px; height: 200px; transform-style: preserve-3d; animation: rotateCube 20s infinite linear; }
  .cube-face { position: absolute; width: 200px; height: 200px; background: rgba(0, 255, 0, 0.2); border: 1px solid #0F0; display: flex; justify-content: center; align-items: center; box-shadow: inset 0 0 10px rgba(0,255,0,0.5); -webkit-backdrop-filter: blur(2px); backdrop-filter: blur(2px); }
      .cube-face-inner { width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 10px; padding: 20px; box-sizing: border-box; background: rgba(0, 0, 0, 0.5); }
      .cube-face.front  { transform: rotateY(0deg) translateZ(100px); } .cube-face.back { transform: rotateY(180deg) translateZ(100px); } .cube-face.right { transform: rotateY(90deg) translateZ(100px); } .cube-face.left { transform: rotateY(-90deg) translateZ(100px); } .cube-face.top { transform: rotateX(90deg) translateZ(100px); } .cube-face.bottom { transform: rotateX(-90deg) translateZ(100px); }
      .fractal-branch { transform-origin: center center; transition: transform 0.8s ease-out, opacity 0.5s ease-out; }
      .fractal-branch .cube { transition: transform 0.2s ease-out; }
      .fractal-branch .cube-face { transition: box-shadow 0.2s ease-out, border-color 0.2s ease-out; }
      .fractal-branch:hover .cube { transform: scale(1.1); }
      .fractal-branch:hover .cube-face { border-color: #0ff; box-shadow: inset 0 0 15px rgba(0, 255, 255, 0.8), 0 0 10px rgba(0, 255, 255, 0.5); }
      .fractal-input { font-family: 'Press Start 2P', cursive; text-align: center; padding: 5px; background: rgba(0, 0, 0, 0.7); border: 1px solid #0F0; color: #0F0; font-size: 0.7rem; width: 100%; transition: all 0.2s; }
      .fractal-input::placeholder { color: rgba(0, 255, 0, 0.5); }
      .fractal-input:focus { outline: none; border-color: #0ff; box-shadow: 0 0 5px rgba(0, 255, 255, 0.6); }
      .fractal-input.input-error { border-color: #f00; box-shadow: 0 0 8px rgba(255,0,0,0.7); }
      .fractal-button { background-color: #0F0; color: #000; text-shadow: none; padding: 6px 12px; border: none; font-size: 0.8rem; box-shadow: 2px 2px #000; }
      .fractal-button:disabled { background-color: #555; color: #aaa; cursor: not-allowed; }
      .suggestions-list {
        position: absolute; top: 100%; left: 0; right: 0; background: #080808; border: 1px solid #0F0; z-index: 20; list-style: none; padding: 0; margin-top: 2px; max-height: 120px; overflow-y: auto;
      }
      .suggestions-list li { padding: 6px 10px; cursor: pointer; font-size: 0.7rem; transition: all 0.1s; }
      .suggestions-list li:hover, .suggestions-list li.suggestion-highlighted { background-color: #0F0; color: #000; text-shadow: none; }
      .arcade-close-button {
        position: absolute; top: 8px; right: 8px; width: 30px; height: 30px; background: #f00; color: #fff; border: 2px solid #fff; font-family: 'Press Start 2P', cursive; font-size: 16px; line-height: 1; text-shadow: 1px 1px #000; box-shadow: 2px 2px #000; cursor: pointer; z-index: 10;
      }
      .arcade-close-button:hover { background: #ff5555; }
      .arcade-close-button:active { transform: translate(1px, 1px); box-shadow: 1px 1px #000; }

      /* Modals and Overlays */
      .modal-backdrop { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); z-index: 40; display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s ease-out; }
      .modal-content {
        background: #080808; border: 2px solid #0f0; padding: 2rem; box-shadow: inset 0 0 15px rgba(0,255,0,0.5), 0 0 10px #0f0; width: 90%; max-width: 1000px; max-height: 90vh; position: relative; animation: modal-content-swoop-in 0.4s ease-out;
      }
      .recipe-result-modal { max-width: 1200px; padding: 1rem; }
      .recipe-details-scroll { height: calc(85vh - 2rem); overflow-y: auto; padding-right: 1rem; }
      .retro-terminal { background: #000; border: 1px solid #0a0; padding: 10px; margin-top: 15px; font-family: monospace; font-size: 0.8rem; color: #0f0; max-height: 150px; overflow-y: auto; }
      .retro-terminal h4 { text-transform: uppercase; color: #0f0; border-bottom: 1px solid #0a0; margin-bottom: 5px; }
      .recipe-image-retro { border: 4px solid #0f0; box-shadow: 4px 4px #000; }
      .instruction-step { opacity: 0; transform: translateY(15px); transition: opacity 0.4s ease-out, transform 0.4s ease-out; }
      .instruction-step.visible { opacity: 1; transform: translateY(0); }
      
      /* Loading State */
      .loading-background-container { position: fixed; inset: 0; background-size: cover; background-position: center; z-index: 49; transition: opacity 0.5s; opacity: 1; }
  .cosmic-kitchen-bg { background-image: url('https://storage.googleapis.com/generative-ai-cookbook/creative-code-collections/fractal-recipe/cosmic.jpg'); }
  .cyberpunk-diner-bg { background-image: url('https://storage.googleapis.com/generative-ai-cookbook/creative-code-collections/fractal-recipe/cyberpunk.jpg'); }
  .enchanted-forest-bg { background-image: url('https://storage.googleapis.com/generative-ai-cookbook/creative-code-collections/fractal-recipe/forest.jpg'); }
      .scanline-overlay { position: fixed; inset: 0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06)); background-size: 100% 3px, 3px 100%; z-index: 50; pointer-events: none; animation: scanline 10s linear infinite; }
      .loading-ellipsis span { animation: pop-in-out 1.5s infinite; } .loading-ellipsis span:nth-child(2) { animation-delay: 0.2s; } .loading-ellipsis span:nth-child(3) { animation-delay: 0.4s; }
      .recipe-loader, .analysis-loader, .video-loader { border: 4px solid #0f0; border-radius: 50%; width: 60px; height: 60px; margin-bottom: 1rem; }
      .recipe-loader { border-top-color: #ff0; animation: spin 1s linear infinite; }
      .analysis-loader { border-left-color: #0ff; animation: spin 1.2s linear infinite reverse; }
      .video-loader { border-right-color: #f0f; animation: spin 0.8s linear infinite; }
      @keyframes spin { to { transform: rotate(360deg); } }

  /* Delay classes to avoid inline styles for instruction steps */
  .delay-step-0 { transition-delay: 0ms; }
  .delay-step-1 { transition-delay: 150ms; }
  .delay-step-2 { transition-delay: 300ms; }
  .delay-step-3 { transition-delay: 450ms; }
  .delay-step-4 { transition-delay: 600ms; }
  .delay-step-5 { transition-delay: 750ms; }
  .delay-step-6 { transition-delay: 900ms; }
  .delay-step-7 { transition-delay: 1050ms; }
  .delay-step-8 { transition-delay: 1200ms; }
  .delay-step-9 { transition-delay: 1350ms; }
  .delay-step-10 { transition-delay: 1500ms; }
  .delay-step-11 { transition-delay: 1650ms; }
  .delay-step-12 { transition-delay: 1800ms; }
  .delay-step-13 { transition-delay: 1950ms; }
  .delay-step-14 { transition-delay: 2100ms; }
  .delay-step-15 { transition-delay: 2250ms; }
  .delay-step-16 { transition-delay: 2400ms; }
  .delay-step-17 { transition-delay: 2550ms; }
  .delay-step-18 { transition-delay: 2700ms; }
  .delay-step-19 { transition-delay: 2850ms; }
  .delay-step-20 { transition-delay: 3000ms; }
  .delay-step-21 { transition-delay: 3150ms; }
  .delay-step-22 { transition-delay: 3300ms; }
  .delay-step-23 { transition-delay: 3450ms; }

      /* Error Notification */
      .error-notification-box {
        position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background-color: #200; border: 2px solid #f00; padding: 15px; z-index: 100; box-shadow: 0 0 10px #f00; display: flex; align-items: center; gap: 10px; animation: fadeInUp 0.5s ease-out;
      }

      /* Video Creation UI */
      .video-container { position: relative; background: #000; border: 2px solid #0f0; }
      .video-controls-overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.5); display: flex; flex-direction: column; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s; cursor: pointer; }
      .video-controls-overlay.visible { opacity: 1; }
      .volume-slider { width: 80%; margin-top: 1rem; }
      .theme-selector-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 8px; }
      .theme-item { cursor: pointer; border: 2px solid transparent; padding: 2px; transition: border-color 0.2s; }
      .theme-item.selected { border-color: #ff0; animation: theme-glow-pulse 1.5s infinite; }
      .theme-item-preview { width: 100%; aspect-ratio: 1/1; background-size: cover; background-position: center; background-color: #222; display: flex; align-items: center; justify-content: center; }
      .theme-item.none-theme .theme-item-preview { background-color: #111; border: 1px dashed #444; }
      .theme-item-name { text-align: center; font-size: 0.6rem; margin-top: 4px; color: #ccc; }
      .share-indicator-container { position: relative; }
      .share-indicator-text { position: absolute; bottom: 120%; left: 50%; transform: translateX(-50%); background: #ff0; color: #000; text-shadow: none; padding: 4px 8px; font-size: 0.6rem; white-space: nowrap; animation: pop-in-out 2.5s forwards; }
      .progress-bar-container { width: 80%; max-width: 300px; height: 10px; border: 1px solid #0f0; margin-top: 1rem; }
      .progress-bar-inner { width: 100%; height: 100%; background-color: #0f0; animation: fake-progress 10s linear infinite; }
    </style>
  <link rel="stylesheet" href="/index.css">
</head>
  <body>
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
  </body>
</html>
